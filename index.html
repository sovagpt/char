<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Best Friends Animal Sponsorship Voting</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            min-height: 100vh;
            background: linear-gradient(135deg, #ff6b6b 0%, #ffa500 50%, #ffec8b 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            overflow-x: hidden;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
            animation: fadeInDown 1s ease-out;
        }

        h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .paw-icon {
            animation: bounce 2s ease-in-out infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .tagline {
            font-size: 1.3rem;
            opacity: 0.95;
            font-weight: 500;
        }

        .timer-container {
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(15px);
            border-radius: 50px;
            padding: 20px 40px;
            margin-bottom: 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            animation: fadeIn 1s ease-out 0.3s both;
            border: 2px solid rgba(255,255,255,0.4);
        }

        .timer {
            color: white;
            font-size: 2.5rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .timer-label {
            font-size: 1.1rem;
            opacity: 0.95;
        }

        .cards-container {
            display: flex;
            gap: 40px;
            margin-bottom: 40px;
            flex-wrap: wrap;
            justify-content: center;
            perspective: 1000px;
        }

        .animal-card {
            background: white;
            border-radius: 25px;
            overflow: hidden;
            width: 350px;
            box-shadow: 0 25px 70px rgba(0,0,0,0.35);
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            animation: float 6s ease-in-out infinite;
            transform-style: preserve-3d;
            position: relative;
        }

        .animal-card:nth-child(1) {
            animation: float 6s ease-in-out infinite, fadeInUp 0.5s ease-out 0.1s both;
        }

        .animal-card:nth-child(2) {
            animation: float 6s ease-in-out infinite 2s, fadeInUp 0.5s ease-out 0.3s both;
        }

        .animal-card:nth-child(3) {
            animation: float 6s ease-in-out infinite 4s, fadeInUp 0.5s ease-out 0.5s both;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotateX(0) rotateY(0); }
            25% { transform: translateY(-10px) rotateX(2deg) rotateY(-2deg); }
            50% { transform: translateY(0) rotateX(0) rotateY(0); }
            75% { transform: translateY(-5px) rotateX(-2deg) rotateY(2deg); }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.03); }
        }

        .animal-card:hover {
            transform: translateY(-15px) scale(1.05);
            box-shadow: 0 35px 90px rgba(0,0,0,0.45);
        }

        .animal-card.voted {
            transform: translateY(-20px) scale(1.08);
            animation: pulse 2s ease-in-out infinite;
            box-shadow: 0 0 0 5px rgba(255, 107, 107, 0.5);
        }

        .animal-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
            transition: transform 0.3s;
        }

        .animal-card:hover .animal-image {
            transform: scale(1.1);
        }

        .animal-content {
            padding: 25px;
        }

        .animal-type-badge {
            display: inline-block;
            background: linear-gradient(135deg, #ff6b6b, #ffa500);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: bold;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .animal-name {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
        }

        .animal-description {
            color: #666;
            line-height: 1.6;
            margin-bottom: 20px;
            height: 80px;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 4;
            -webkit-box-orient: vertical;
        }

        .vote-section {
            border-top: 2px solid #f0f0f0;
            padding-top: 20px;
        }

        .vote-count {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(255, 165, 0, 0.1));
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            font-weight: bold;
            color: #ff6b6b;
            font-size: 1.2rem;
            margin-bottom: 15px;
            transition: all 0.3s;
        }

        .voted .vote-count {
            background: linear-gradient(135deg, #ff6b6b, #ffa500);
            color: white;
            transform: scale(1.05);
        }

        .vote-button {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 15px;
            background: linear-gradient(135deg, #ff6b6b, #ffa500);
            color: white;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .vote-button:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(255, 107, 107, 0.4);
        }

        .voted .vote-button {
            background: linear-gradient(135deg, #4CAF50, #45a049);
        }

        .voted .vote-button::after {
            content: " ✓";
        }

        .results-container {
            background: white;
            border-radius: 25px;
            padding: 40px;
            max-width: 700px;
            width: 100%;
            box-shadow: 0 25px 70px rgba(0,0,0,0.35);
            animation: fadeIn 0.5s ease-out;
        }

        .round-winner {
            text-align: center;
            margin-bottom: 30px;
        }

        .winner-icon {
            font-size: 5rem;
            margin-bottom: 15px;
            animation: bounce 2s ease-in-out infinite;
        }

        .winner-image {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            object-fit: cover;
            margin: 20px auto;
            border: 5px solid #ff6b6b;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        .winner-name {
            font-size: 2.5rem;
            background: linear-gradient(135deg, #ff6b6b, #ffa500);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .winner-votes {
            font-size: 1.3rem;
            color: #666;
            margin-bottom: 10px;
        }

        .winner-description {
            color: #888;
            line-height: 1.6;
            max-width: 500px;
            margin: 0 auto 20px;
        }

        .next-round-btn {
            width: 100%;
            padding: 18px;
            margin-top: 25px;
            border: none;
            border-radius: 15px;
            background: linear-gradient(135deg, #ff6b6b, #ffa500);
            color: white;
            font-size: 1.3rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .next-round-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 15px 40px rgba(255, 107, 107, 0.4);
        }

        .history {
            margin-top: 35px;
            padding-top: 35px;
            border-top: 3px solid #f0f0f0;
        }

        .history h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        .history-item {
            padding: 15px;
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.05), rgba(255, 165, 0, 0.05));
            border-radius: 15px;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }

        .history-item:hover {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(255, 165, 0, 0.1));
            transform: translateX(5px);
        }

        .history-animal {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .history-image {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
        }

        .history-round {
            font-weight: bold;
            color: #ff6b6b;
        }

        .loading {
            color: white;
            font-size: 1.5rem;
            text-align: center;
            padding: 50px;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            
            .cards-container {
                flex-direction: column;
                gap: 25px;
            }
            
            .animal-card {
                width: 100%;
                max-width: 400px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1><span class="paw-icon">🐾</span> Best Friends Animal Sanctuary <span class="paw-icon">🐾</span></h1>
        <p class="tagline">Vote for your favorite rescue animal • Every 10 minutes, a new winner!</p>
    </div>

    <div class="timer-container">
        <div class="timer">
            <span class="timer-label">Next round in:</span>
            <span id="timer">10:00</span>
        </div>
    </div>

    <div id="voting-area">
        <div class="cards-container" id="cards-container"></div>
    </div>

    <div id="results-area" style="display: none;">
        <div class="results-container">
            <div class="round-winner">
                <div class="winner-icon">🏆</div>
                <h2>Round Winner!</h2>
                <img class="winner-image" id="winner-image" src="" alt="">
                <div class="winner-name" id="winner-name"></div>
                <div class="winner-votes" id="winner-votes"></div>
                <div class="winner-description" id="winner-description"></div>
            </div>
            <button class="next-round-btn" onclick="startNewRound()">Start Next Round →</button>
            <div class="history" id="history">
                <h3>🏅 Previous Winners</h3>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCzcVwv8qs3eUny79eLIsqPu3cyybbDnuA",
            authDomain: "animal-voting.firebaseapp.com",
            databaseURL: "https://animal-voting-default-rtdb.firebaseio.com",
            projectId: "animal-voting",
            storageBucket: "animal-voting.firebasestorage.app",
            messagingSenderId: "606364151440",
            appId: "1:606364151440:web:ac16809e27f242e77fb215",
            measurementId: "G-WXCXYQH30F"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Animal data pool based on Best Friends animals
        const animalPool = [
            {
                name: "Batman",
                type: "Cat",
                description: "A mysterious and charming feline who loves to patrol the sanctuary at night. Despite his tough name, he's incredibly gentle.",
                image: "https://images.unsplash.com/photo-1514888286974-6c03e2ca1dba?w=400&h=300&fit=crop"
            },
            {
                name: "Blueberry",
                type: "Rabbit",
                description: "This adorable bunny got her name from her love of fresh berries. She's playful and loves to hop around in the grass.",
                image: "https://images.unsplash.com/photo-1535241749838-299277b6305f?w=400&h=300&fit=crop"
            },
            {
                name: "Brussels Sprout",
                type: "Guinea Pig",
                description: "Don't let the veggie name fool you - this little guy has a huge personality and loves cuddles more than anything.",
                image: "https://images.unsplash.com/photo-1548767797-d8c844163c4c?w=400&h=300&fit=crop"
            },
            {
                name: "Bryce",
                type: "Dog",
                description: "A loyal companion who came to the sanctuary after being found as a stray. He's learning to trust again and loves belly rubs.",
                image: "https://images.unsplash.com/photo-1587300003388-59208cc962cb?w=400&h=300&fit=crop"
            },
            {
                name: "Caboodle",
                type: "Dog",
                description: "Kit's brother who has a neurological condition but doesn't let it slow him down. Loves playing with friends and rolling in snow.",
                image: "https://images.unsplash.com/photo-1548199973-03cce0bbc87b?w=400&h=300&fit=crop"
            },
            {
                name: "Cameo",
                type: "Pig",
                description: "A gentle, affectionate pig who loves mud baths and lazy afternoons. Found as a stray in 2013, now living her best life.",
                image: "https://images.unsplash.com/photo-1516467508483-a7212febe31a?w=400&h=300&fit=crop"
            },
            {
                name: "Captain",
                type: "Dog",
                description: "Leading his pack with courage and kindness. This brave pup overcame a difficult past and now helps other dogs feel safe.",
                image: "https://images.unsplash.com/photo-1552053831-71594a27632d?w=400&h=300&fit=crop"
            },
            {
                name: "Clancy",
                type: "Cat",
                description: "An Irish charmer with emerald eyes and a purr that could melt hearts. Loves sunny windowsills and head scratches.",
                image: "https://images.unsplash.com/photo-1573865526739-10659fec78a5?w=400&h=300&fit=crop"
            },
            {
                name: "Dean Martin",
                type: "Dog",
                description: "Smooth as his namesake, this crooner loves to 'sing' along when music plays. A true entertainer at heart.",
                image: "https://images.unsplash.com/photo-1477884213360-7e9d7dcc1e48?w=400&h=300&fit=crop"
            },
            {
                name: "Hudson",
                type: "Cat",
                description: "Has cerebellar hypoplasia but doesn't let it stop him. This special needs kitty is full of love and determination.",
                image: "https://images.unsplash.com/photo-1519052537078-e6302a4968d4?w=400&h=300&fit=crop"
            },
            {
                name: "Jelly Bean",
                type: "Cat",
                description: "A clever kitty with a mild neurological condition and deafness, but she's learned to navigate the world in her own special way.",
                image: "https://images.unsplash.com/photo-1478098711619-5ab0b478d6e6?w=400&h=300&fit=crop"
            },
            {
                name: "Jewel",
                type: "Horse",
                description: "A precious gem of the sanctuary, this gentle mare loves carrots and gentle brushing sessions with volunteers.",
                image: "https://images.unsplash.com/photo-1553284965-83fd3e82fa5a?w=400&h=300&fit=crop"
            },
            {
                name: "Kit",
                type: "Dog",
                description: "Sweet as can be despite her neurological challenges. Loves playing with dog friends and has an incredible spirit.",
                image: "https://images.unsplash.com/photo-1561037404-61cd46aa615b?w=400&h=300&fit=crop"
            },
            {
                name: "Koda",
                type: "Cat",
                description: "Quirky and affectionate, loves perching on shoulders and zooming through cat tunnels. Not a fan of loud noises but loves hugs.",
                image: "https://images.unsplash.com/photo-1511044568932-338cba0ad803?w=400&h=300&fit=crop"
            },
            {
                name: "Reindeer",
                type: "Cat",
                description: "A former mom cat learning to trust people again. First at the door to say hello despite being fearful. Full-figured and fabulous.",
                image: "https://images.unsplash.com/photo-1494256997604-768d1f608cac?w=400&h=300&fit=crop"
            },
            {
                name: "Snickers",
                type: "Horse",
                description: "Sweet as the candy bar she's named after. This beautiful horse loves trail rides and making new human friends.",
                image: "https://images.unsplash.com/photo-1534278931827-8a259344abe7?w=400&h=300&fit=crop"
            },
            {
                name: "Tony",
                type: "Horse",
                description: "A gentle giant with a heart of gold. Tony loves apples and has become a favorite among sanctuary visitors.",
                image: "https://images.unsplash.com/photo-1450052590821-8bf91254a353?w=400&h=300&fit=crop"
            },
            {
                name: "Bossco",
                type: "Dog",
                description: "Has a collapsed trachea but doesn't let it dim his spirit. This brave little guy needs special care but gives endless love.",
                image: "https://images.unsplash.com/photo-1583511655857-d19b40a7a54e?w=400&h=300&fit=crop"
            }
        ];

        let currentAnimals = [];
        let usedAnimals = [];
        let votes = {};
        let timer = 600; // 10 minutes in seconds
        let timerInterval;
        let roundNumber = 1;
        let winners = [];
        let hasVoted = false;
        let currentRoundRef = null;

        function getRandomAnimals() {
            // Reset used animals if we've gone through all
            if (usedAnimals.length >= animalPool.length - 3) {
                usedAnimals = [];
            }

            const available = animalPool.filter(animal => 
                !usedAnimals.some(used => used.name === animal.name)
            );

            const shuffled = [...available].sort(() => Math.random() - 0.5);
            const selected = shuffled.slice(0, 3);
            
            usedAnimals.push(...selected);
            return selected;
        }

        function createAnimalCard(animal, index) {
            const card = document.createElement('div');
            card.className = 'animal-card';
            card.id = `animal-${index}`;
            
            card.innerHTML = `
                <img src="${animal.image}" alt="${animal.name}" class="animal-image">
                <div class="animal-content">
                    <span class="animal-type-badge">${animal.type}</span>
                    <div class="animal-name">${animal.name}</div>
                    <div class="animal-description">${animal.description}</div>
                    <div class="vote-section">
                        <div class="vote-count">Votes: <span id="votes-${index}">0</span></div>
                        <button class="vote-button" onclick="vote(${index})">Vote for ${animal.name}</button>
                    </div>
                </div>
            `;
            
            return card;
        }

        function vote(index) {
            if (hasVoted) {
                alert("You've already voted in this round! Wait for the next round to vote again.");
                return;
            }
            
            votes[index] = (votes[index] || 0) + 1;
            
            // Update local display
            document.getElementById(`votes-${index}`).textContent = votes[index];
            
            // Update Firebase
            if (currentRoundRef) {
                currentRoundRef.child('votes').child(index).set(votes[index]);
                currentRoundRef.child('animals').child(index).update({
                    voteCount: votes[index]
                });
            }
            
            // Mark as voted
            document.querySelectorAll('.animal-card').forEach(card => {
                card.classList.remove('voted');
            });
            document.getElementById(`animal-${index}`).classList.add('voted');
            
            hasVoted = true;
        }

        function updateTimer() {
            const minutes = Math.floor(timer / 60);
            const seconds = timer % 60;
            document.getElementById('timer').textContent = 
                `${minutes}:${seconds.toString().padStart(2, '0')}`;
            
            if (timer <= 0) {
                endRound();
            } else {
                timer--;
            }
        }

        function endRound() {
            clearInterval(timerInterval);
            
            // Find winner
            let maxVotes = 0;
            let winnerIndex = 0;
            for (let i in votes) {
                if (votes[i] > maxVotes) {
                    maxVotes = votes[i];
                    winnerIndex = i;
                }
            }
            
            const winner = currentAnimals[winnerIndex];
            winner.votes = maxVotes;
            winner.round = roundNumber;
            winners.push(winner);
            
            // Save winner to Firebase
            if (currentRoundRef) {
                currentRoundRef.update({
                    winner: winner,
                    endTime: Date.now(),
                    status: 'completed'
                });
                
                // Save to winners collection
                database.ref('winners').push({
                    ...winner,
                    timestamp: Date.now()
                });
            }
            
            // Show results
            showResults(winner);
        }

        function showResults(winner) {
            document.getElementById('voting-area').style.display = 'none';
            document.getElementById('results-area').style.display = 'block';
            
            document.getElementById('winner-image').src = winner.image;
            document.getElementById('winner-name').textContent = winner.name;
            document.getElementById('winner-votes').textContent = 
                `${winner.votes} vote${winner.votes !== 1 ? 's' : ''}`;
            document.getElementById('winner-description').textContent = winner.description;
            
            updateHistory();
        }

        function updateHistory() {
            const historyContainer = document.getElementById('history');
            historyContainer.innerHTML = '<h3>🏅 Previous Winners</h3>';
            
            winners.slice(-5).reverse().forEach(winner => {
                const item = document.createElement('div');
                item.className = 'history-item';
                item.innerHTML = `
                    <div class="history-animal">
                        <img src="${winner.image}" alt="${winner.name}" class="history-image">
                        <span>${winner.name} (${winner.type})</span>
                    </div>
                    <span class="history-round">Round ${winner.round} - ${winner.votes} votes</span>
                `;
                historyContainer.appendChild(item);
            });
        }

        function startNewRound() {
            roundNumber++;
            hasVoted = false;
            votes = {};
            timer = 600;
            
            // Get new animals
            currentAnimals = getRandomAnimals();
            
            // Create Firebase round
            currentRoundRef = database.ref('rounds').push({
                roundNumber: roundNumber,
                startTime: Date.now(),
                status: 'active',
                animals: currentAnimals.map(animal => ({
                    ...animal,
                    voteCount: 0
                })),
                votes: {}
            });
            
            // Reset display
            document.getElementById('voting-area').style.display = 'block';
            document.getElementById('results-area').style.display = 'none';
            
            // Create new cards
            const container = document.getElementById('cards-container');
            container.innerHTML = '';
            currentAnimals.forEach((animal, index) => {
                container.appendChild(createAnimalCard(animal, index));
            });
            
            // Start timer
            timerInterval = setInterval(updateTimer, 1000);
        }

        // Initialize first round
        window.onload = function() {
            // Firebase is now configured with your credentials!
            console.log("Firebase connected successfully!");
            startNewRound();
        };
    </script>
</body>
</html>
